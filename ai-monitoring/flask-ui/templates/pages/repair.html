{% extends 'base.html' %}

{% block title %}Repair System - AI Monitoring Demo{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/repair.css') }}">
{% endblock %}

{% block content %}
<div class="repair-container">
    <h1>ğŸ”§ Autonomous Repair System</h1>
    <p>Trigger the AI agent to autonomously diagnose and repair system failures.</p>

    <!-- Model Selection -->
    <div class="config-section">
        <h2>Configuration</h2>
        <div class="form-group">
            <label for="model-select">Select Model:</label>
            <select id="model-select" class="form-control">
                <option value="a">Model A (Fast & Reliable)</option>
                <option value="b">Model B (Ultra Lightweight)</option>
                <option value="compare">Compare Both</option>
            </select>
        </div>
    </div>

    <hr>

    <!-- Container Status -->
    <section class="status-section">
        <h2>ğŸ“Š System Status</h2>
        <button id="refresh-status-btn" class="btn btn-secondary">ğŸ”„ Refresh</button>
        <div id="container-grid" class="container-grid">
            <div class="loading">Loading container status...</div>
        </div>
    </section>

    <hr>

    <!-- Repair Trigger -->
    <section class="trigger-section">
        <h2>ğŸš€ Trigger Repair</h2>
        <button id="trigger-repair-btn" class="btn btn-primary">Run Repair</button>
        <div id="repair-progress" style="display: none;">
            <div class="spinner"></div>
            <p>Running repair workflow... This may take 1-3 minutes</p>
        </div>
    </section>

    <hr>

    <!-- Repair Results -->
    <section id="repair-results" style="display: none;">
        <h2>ğŸ“ Repair Results</h2>
        <div id="results-content"></div>
    </section>

    <hr>

    <!-- Container Logs Viewer -->
    <section class="logs-section">
        <h2>ğŸ“œ Container Logs</h2>
        <div class="logs-controls">
            <select id="container-select" class="form-control">
                <option value="aim-target-app">aim-target-app</option>
                <option value="aim-chaos-engine">aim-chaos-engine</option>
                <option value="aim-mcp-server">aim-mcp-server</option>
                <option value="aim-ai-agent">aim-ai-agent</option>
                <option value="aim-ollama-model-a">aim-ollama-model-a</option>
                <option value="aim-ollama-model-b">aim-ollama-model-b</option>
            </select>
            <input type="number" id="log-lines" class="form-control" value="100" min="10" max="500">
            <button id="fetch-logs-btn" class="btn btn-secondary">ğŸ“– Fetch Logs</button>
        </div>
        <div class="logs-filter">
            <label class="checkbox-label">
                <input type="checkbox" id="filter-health-checks" checked>
                <span>Hide monitoring/polling logs (health checks, metrics, stats)</span>
            </label>
        </div>
        <pre id="logs-display" style="display: none;"></pre>
    </section>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/repair.js') }}"></script>
{% endblock %}
